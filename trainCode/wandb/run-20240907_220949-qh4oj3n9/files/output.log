Overriding model.yaml nc=80 with nc=22
Transferred 469/475 items from pretrained weights
Freezing layer 'model.22.dfl.conv.weight'
[34m[1mAMP: [0mrunning Automatic Mixed Precision (AMP) checks with YOLOv8n...
[34m[1mAMP: [0mchecks passed âœ…
/home/kai/miniconda3/envs/yolov8/lib/python3.12/site-packages/ultralytics/engine/trainer.py:271: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(enabled=self.amp)
[34m[1mtrain: [0mScanning /mnt/data/kai/VinDr_YOLOv8_experiments/datasets/FULL_1024_brightnessEQ_FIXED/labels/train... 3615 images, 8385[0m
[34m[1mtrain: [0mNew cache created: /mnt/data/kai/VinDr_YOLOv8_experiments/datasets/FULL_1024_brightnessEQ_FIXED/labels/train.cache
[34m[1mval: [0mScanning /mnt/data/kai/VinDr_YOLOv8_experiments/datasets/FULL_1024_brightnessEQ_FIXED/labels/val... 907 images, 2093 back[0m
[34m[1mval: [0mNew cache created: /mnt/data/kai/VinDr_YOLOv8_experiments/datasets/FULL_1024_brightnessEQ_FIXED/labels/val.cache
Plotting labels to train_VinDr_YOLOv8/07092024_YOLOv8s_FIXEDBB/labels.jpg...
[34m[1moptimizer:[0m 'optimizer=auto' found, ignoring 'lr0=0.01' and 'momentum=0.937' and determining best 'optimizer', 'lr0' and 'momentum' automatically...
[34m[1moptimizer:[0m AdamW(lr=0.000714, momentum=0.9) with parameter groups 77 weight(decay=0.0), 84 weight(decay=0.0005), 83 bias(decay=0.0)
Image sizes 1024 train, 1024 val
Using 16 dataloader workers
Logging results to [1mtrain_VinDr_YOLOv8/07092024_YOLOv8s_FIXEDBB[0m
Starting training for 3 epochs...

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
        1/3      8.41G       2.36      6.828      2.416         16       1024: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750/750 [04:05<00:00,  3.06it/
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 188/188 [00:37<00:0
                   all       3000       7588      0.231     0.0844     0.0156    0.00553

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
        2/3       8.4G      2.179      3.886      2.325         14       1024: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750/750 [04:01<00:00,  3.10it/
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 188/188 [00:39<00:0
                   all       3000       7588      0.443     0.0438     0.0273     0.0113

      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
        3/3      8.65G      2.035      3.482      2.204         29       1024: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 750/750 [03:59<00:00,  3.13it/
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 188/188 [00:38<00:0
                   all       3000       7588       0.42     0.0597      0.036     0.0152

3 epochs completed in 0.236 hours.
Optimizer stripped from train_VinDr_YOLOv8/07092024_YOLOv8s_FIXEDBB/weights/last.pt, 52.1MB
Optimizer stripped from train_VinDr_YOLOv8/07092024_YOLOv8s_FIXEDBB/weights/best.pt, 52.1MB

Validating train_VinDr_YOLOv8/07092024_YOLOv8s_FIXEDBB/weights/best.pt...
Ultralytics YOLOv8.2.80 ðŸš€ Python-3.12.5 torch-2.4.0 CUDA:0 (NVIDIA GeForce RTX 2080 Ti, 11012MiB)
                                                     CUDA:1 (NVIDIA GeForce RTX 2080 Ti, 11004MiB)
Model summary (fused): 218 layers, 25,852,498 parameters, 0 gradients, 78.8 GFLOPs
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 188/188 [00:35<00:0
                   all       3000       7588      0.417     0.0601     0.0359     0.0152
    Aortic enlargement        620       1464      0.323      0.397      0.275      0.117
           Atelectasis         40         53          0          0     0.0171    0.00573
         Calcification         94        184          1          0          0          0
          Cardiomegaly        463       1111      0.191      0.712      0.326      0.156
     Clavicle fracture          6          6          0          0          0          0
         Consolidation         79        122          1          0    0.00814    0.00225
                 Edema          2          5          0          0          0          0
             Emphysema         16         25          1          0    0.00506   0.000506
           Enlarged PA         28         38          0          0          0          0
                   ILD         79        205          1          0     0.0102    0.00386
          Infiltration        125        258      0.415     0.0194     0.0414     0.0111
          Lung Opacity        277        497       0.11    0.00201     0.0153    0.00471
           Lung cavity         10         23          0          0          0          0
             Lung cyst          8          8          0          0          0          0
     Mediastinal shift         34         61          1          0    0.00924    0.00329
           Nodule/Mass        173        554          0          0    0.00172   0.000573
      Pleural effusion        214        501      0.125      0.192     0.0611     0.0226
    Pleural thickening        402        931          1          0    0.00292    0.00084
          Pneumothorax         25         68          0          0          0          0
    Pulmonary fibrosis        327        943          1          0     0.0148    0.00441
          Rib fracture         19         52          0          0          0          0
          Other lesion        231        479          1          0    0.00189   0.000189
Speed: 0.3ms preprocess, 10.0ms inference, 0.0ms loss, 0.8ms postprocess per image
Results saved to [1mtrain_VinDr_YOLOv8/07092024_YOLOv8s_FIXEDBB[0m
